
b=1000;%initial size of the unattached bacteria
b_e=0;%initial size of the attached bacteria to endothelial
b_n=0;
b_i=0;
b_a=0;
n=10^-8;%initial neutrophils

time=2160;%time in hours


options = odeset('AbsTol',1e-13,'RelTol',1e-15);
[t,y]=ode45(@(t,y)Equations(t,y),0:time,[b,b_n,b_i,n,b_a],options);

total_NG=y(:,1)+y(:,2)+y(:,3)+y(:,5);


lfs = 16;
lfn = 'Arial';
linewidth=1.5;
xo = 0.1;
yo = 0.1;
%figure
time2=2160;
options = odeset('AbsTol',1e-13,'RelTol',1e-13);
[t2,y2]=ode45(@(t,y)Equations(t,y),0:time2,[b,b_n,b_i,n,b_a],options);

total_NG=y2(:,1)+y2(:,2)+y2(:,3)+y2(:,5);

rectangle('Position',[1 1*10^6 90 1*10^7],'EdgeColor',[192,192,192]./255,'FaceColor',[192,192,192]./255)
rectangle('Position',[1 1*10^-8 6 1*10^8],'EdgeColor',[0.6902 .7686 .8706],'FaceColor',[0.6902 .7686 .8706])
rectangle('Position',[30 1*10^-8 60 1*10^6],'EdgeColor',[0.6902 .7686 .8706],'FaceColor',[0.6902 .7686 .8706])


hold on
% plot(t2/24,y2(:,1),'color',[255,160,122]./255,'LineWidth',linewidth);%
% set(gca, 'YScale', 'log')
% hold on
% plot(t2/24,y2(:,5),'-.','color',[250,128,114]./255,'LineWidth',linewidth);%
% set(gca, 'YScale', 'log')
% hold on
% plot(t2/24,y2(:,3),'--','color',[205,92,92]./255,'LineWidth',linewidth);%
% set(gca, 'YScale', 'log')
% hold on
% plot(t2/24,y2(:,2),'color',[178,34,34]./255,'LineWidth',linewidth);%
% set(gca, 'YScale', 'log')
% hold on
% plot(t2/24,y2(:,4),':','color',[0,0,139]./255,'LineWidth',linewidth);
% set(gca, 'YScale', 'log')
hold on
%plot(t2/24,total_NG,'k','LineWidth',0.8);
set(gca, 'YScale', 'log','box','off','Layer','top')
hold on
ngx=0:90;
ngy=10*ones(length(ngx));
plot(ngx,ngy,'k -.')

%plotting data points
hold on
h1=scatter(0,1000,'r','filled');
hold on
scatter(75,10,'r','filled')
hold on
scatter(2.58,1.7*10^6,'b','filled')
hold on
scatter(6.25,1.7*10^6,'b','filled')
hold on
h2=scatter(3.88,5.2*10^6,'b','filled')


legend([h1,h2],{'fixed','random'},'box','off','Position',[0.335061729852064 0.768641977251312 0.0866666652096643 0.0718518499091819])


ylim([1 1*10^7]);
xlim([0 90]);

xt = get(gca, 'XTick');
set(gca, 'FontSize', 16,'FontName',lfn)
yt = get(gca, 'YTick');
set(gca, 'FontSize', 16,'FontName',lfn)
%set(gca,'Position',[0.129746835443038 0.310354077253219 0.371044303797468 0.377414163090129])
yticks([10 10^3 10^6 10^7]);
xticks([1 7 30 60 75 90])
% ratio=[2 1.5 1];
% pbaspect(ratio)
% % 
xlabel('time (days)','FontSize',lfs,'FontName',lfn)
% ylabel('NG and PMN','FontSize',lfs,'FontName',lfn)
ylabel({'Number of bacteria'},'FontSize',lfs,'FontName',lfn)
%yaxis right
text(4,15,'incubation period','FontSize',lfs,'FontName',lfn)
H=findobj(gca,'Type','text');
set(H,'Rotation',90); % tilt

text('FontSize',16,'FontName','Arial',...
    'String','Peak NG load',...
    'Position',[62.4789334120958 2802398.50215916 0]);

annotation('textbox',...
    [0.183222222222222 0.377777777777778 0.150111111111111 0.00148148148148131],...
    'String',{'infection clearence'},...
    'LineStyle','none',...
    'FontSize',14,...
    'FontName','Arial',...
    'FitBoxToText','off');

annotation('textbox',...
    [0.214333333333333 0.30074074074074 0.0760370370370368 0.042962962962963],...
    'String',{'cut-off'},...
    'LineStyle','none',...
    'FontSize',14,...
    'FontName','Arial',...
    'FitBoxToText','off');

annotation('textbox',...
    [0.329148148148148 0.53037037037037 0.144185185185185 0.042962962962963],...
    'String',{'infection duration'},...
    'LineStyle','none',...
    'FontSize',14,...
    'FontName','Arial',...
    'FitBoxToText','off');

annotation('textarrow',[0.0703703703703694 0.111111111111111],...
    [0.788148148148146 0.788148148148146],'TextRotation',90,...
    'String',{'X_2 ~ Uni (1,2),',' Y_2 ~ Uni (10^6, 5 × 10^6)'},...
    'LineStyle','none',...
    'HeadStyle','none',...
    'FontSize',14,...
    'FontName','Arial');
annotation('arrow',[0.0859259259259259 0.142222222222222],...
    [0.710111111111111 0.709629629629629]);
annotation('arrow',[0.195555555555556 0.167407407407407],...
    [0.711111111111111 0.709629629629629]);
annotation('textbox',...
    [0.194074074074074 0.674074075398621 0.14555555143842 0.0592592579347117],...
    'String',{'X_4~Uni (5,7), Y_4=Y_2'},...
    'LineStyle','none',...
    'FontSize',14,...
    'FontName','Arial');

annotation('arrow',[0.151851851851852 0.151851851851852],...
    [0.846407407407407 0.758518518518518]);

annotation('textbox',...
    [0.072111111111111 0.862222222222222 0.228629629629629 0.0370370370370369],...
    'String',{'X_3~Uni (2,5), Y_3 ~ Uni (Y_2,10^7)'},...
    'LineStyle','none',...
    'FontSize',14,...
    'FontName','Arial',...
    'FitBoxToText','off');

annotation('textbox',...
    [0.0884074074074076 0.42074074074074 0.0708518518518515 0.0503703703703702],...
    'String',{'(X_1, Y_1)'},...
    'LineStyle','none',...
    'FontSize',14,...
    'FontName','Arial',...
    'FitBoxToText','off');
annotation('textbox',...
    [0.395074074074074 0.361481481481481 0.0849259259259258 0.0296296296296297],...
    'String','(X_5, Y_5)',...
    'LineStyle','none',...
    'FontSize',14,...
    'FontName','Arial',...
    'FitBoxToText','off');
% legend({'unattached NG','attached NG','NG internalized in epithelial','NG within PMN',...
%     'activated PMN','total NG'},'FontSize',14,'FontName',lfn,'Box','off',...
%      'Position',[0.21366868510124 0.277485281241601 0.206666661633386 0.205185179357175])
%xlabel('Distance, \textit{X}', 'FontName', 'Times New Roman', ...
% 'FontSize',28,'Color','k', 'Interpreter', 'LaTeX')
str1='$$\textit{B}_i$$';
str2='$$\textit{B}_a$$';



